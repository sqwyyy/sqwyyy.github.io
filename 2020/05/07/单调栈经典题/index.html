<p>题意：给出一个序列，要求的是一个区间，这个区间的最小值乘以这个区间数字的和是最大值</p>
<a id="more"></a>
<p><mark>单调栈处理的问题就是对每一个节点进行扩展的问题，<br />
这个题目要维护的是一个单调递减栈，即从栈顶元素到栈底元素，值是单调递减的，即栈顶元素的值始终是栈的最大值。然后每一个值有属于自己的区间，这个区间目的是为了记录之后的元素向前延伸的用处。<br />
向后延伸就靠从1到n扫描元素，(维护单调递减栈)这样当扫描的元素大于栈顶元素时，直接入栈。<br />
当扫描的元素等于栈顶元素时，不记录，只将区间延伸到后面。<br />
当扫描的元素小于栈顶元素时，这时要计算栈内当前的值。因为扫描的元素时小于栈顶元素的，要求的是一个区间的最小值，所以栈内那些大于该元素的值你会发现没有用处了，只需要将它们的那些区间留下来就对了，这就是向前扩展。</mark></p>
<hr />
<p>3 1 6 4 5 2</p>
<p>一开始每一个数都有自己的区间：</p>
<p>3(1,1)  1(2,2)  6(3,3)  4(4,4)  5(5,5)  2(6,6)  -1(7,7)后面加一个最小值，为了最后计算栈内元素使用。</p>
<p>先是3入栈。栈内元素 3(1,1)</p>
<p>1&lt;3，首先计算一下栈内元素的值，记录下来。然后要把栈内大于1的全部弹出来，但是把它们的区间留下，栈内就变成了1(1,2)。实际上此时就会知道(1,2)这段区间之内的最小值是1。<br />
6&gt;1，直接入栈，栈内元素变为1(1,2)，6(3,3)。<br />
4&lt;6，将6弹出，弹出之前计算值。然后栈内就变为1(1,2)，4(3,4)。<br />
5&gt;4，直接入栈。栈内元素是1(1,2),4(3,4),5(5,5)。会发现因为5没有办法向前扩展了所以会知道5只能够在(5,5)的区间内最小，所以说站内元素是在自己区间的左端点与栈顶元素的右端点，这段区间之内满足着最小值的关系。1是在(1,5)这段区间内最小，4是在(3,5)这段区间内最小。这些值都会在碰到扫描的元素小于该元素时计算，记录下来，就是这样单调栈完成了对每一个元素进行左右扩展的目的。<br />
2&lt;5,2&lt;4。要把5(5,5) 4(3,4)分别弹出，它们走之前要计算各自区间的值。<br />
最后是-1，目的就是要将栈内所有元素弹出，计算每一个元素左右扩展的值。</p>
<hr />
<pre><div class="hljs"><code class="lang-c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> N 100001</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ll;
<span class="hljs-keyword">int</span> a[N], lef[N], s[N], top;
<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> sum[N];

<p><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span><br></span>{<br>    ios_base::sync_with_stdio(<span class="hljs-number">0</span>), <span class="hljs-built_in">cin</span>.tie(<span class="hljs-number">0</span>), <span class="hljs-built_in">cout</span>.tie(<span class="hljs-number">0</span>);<br>    ll ans = <span class="hljs-number">-1</span>, tmp;<br>    <span class="hljs-keyword">int</span> i, j, n;<br>    <span class="hljs-keyword">int</span> ll, rr;<br>    <span class="hljs-built_in">cin</span>&gt;&gt;n;<br>    <span class="hljs-built_in">memset</span>(sum, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(sum));<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>    {<br>        <span class="hljs-built_in">cin</span>&gt;&gt;a[i];<br>        sum[i] = sum[i - <span class="hljs-number">1</span>] + a[i];<br>    }<br>    a[++n] = <span class="hljs-number">-1</span>;<br>    top = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>    {<br>        <span class="hljs-keyword">if</span> (top == <span class="hljs-number">0</span> || a[i] &gt; a[s[top - <span class="hljs-number">1</span>]])<br>        {<br>            s[top++] = i;<br>            lef[i] = i;<br>            <span class="hljs-keyword">continue</span>;<br>        }<br>        <span class="hljs-keyword">if</span> (a[i] == a[s[top - <span class="hljs-number">1</span>]])<br>            <span class="hljs-keyword">continue</span>;<br>        <span class="hljs-keyword">while</span> (top &gt;= <span class="hljs-number">1</span> &amp;&amp; a[i] &lt; a[s[top - <span class="hljs-number">1</span>]])<br>        {<br>            –top;<br>            tmp = <span class="hljs-number">1L</span>L*a[s[top]] * (sum[i - <span class="hljs-number">1</span>] - sum[lef[s[top]] - <span class="hljs-number">1</span>]);</p>
<pre><code>        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (tmp &amp;gt; ans)
        {
            ll = lef[s[top]];
            rr = i - &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;
            ans = tmp;
        }
    }
    lef[i] = lef[s[top]];
    s[top++] = i;
}
&lt;span class=&quot;hljs-built_in&quot;&gt;cout&lt;/span&gt;&amp;lt;&amp;lt;ans&amp;lt;&amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;endl&lt;/span&gt;&amp;lt;&amp;lt;l&amp;lt;&amp;lt;&lt;span class=&quot;hljs-string&quot;&gt;&quot; &quot;&lt;/span&gt;&amp;lt;&amp;lt;r&amp;lt;&amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;endl&lt;/span&gt;;
&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;</code></pre><p>}</p>
<p></code></div></pre></p>
